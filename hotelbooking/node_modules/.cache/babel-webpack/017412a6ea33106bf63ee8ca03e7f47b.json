{"ast":null,"code":"import { Observable, asyncScheduler } from 'rxjs';\nimport { map, share } from 'rxjs/operators';\nexport function fromRef(ref, event, listenType = 'on', scheduler = asyncScheduler) {\n  return new Observable(subscriber => {\n    let fn = null;\n    fn = ref[listenType](event, (snapshot, prevKey) => {\n      scheduler.schedule(() => {\n        subscriber.next({\n          snapshot,\n          prevKey\n        });\n      });\n\n      if (listenType == 'once') {\n        scheduler.schedule(() => subscriber.complete());\n      }\n    }, err => {\n      scheduler.schedule(() => subscriber.error(err));\n    });\n\n    if (listenType == 'on') {\n      return {\n        unsubscribe() {\n          if (fn != null) {\n            ref.off(event, fn);\n          }\n        }\n\n      };\n    } else {\n      return {\n        unsubscribe() {}\n\n      };\n    }\n  }).pipe(map(payload => {\n    const {\n      snapshot,\n      prevKey\n    } = payload;\n    let key = null;\n\n    if (snapshot.exists()) {\n      key = snapshot.key;\n    }\n\n    return {\n      type: event,\n      payload: snapshot,\n      prevKey,\n      key\n    };\n  }), share());\n}","map":{"version":3,"sources":["D:/งาน/Project/ProjectHotel/hotelbooking/node_modules/angularfire2/node_modules/@angular/fire/__ivy_ngcc__/database/es2015/observable/fromRef.js"],"names":["Observable","asyncScheduler","map","share","fromRef","ref","event","listenType","scheduler","subscriber","fn","snapshot","prevKey","schedule","next","complete","err","error","unsubscribe","off","pipe","payload","key","exists","type"],"mappings":"AAAA,SAASA,UAAT,EAAqBC,cAArB,QAA2C,MAA3C;AACA,SAASC,GAAT,EAAcC,KAAd,QAA2B,gBAA3B;AACA,OAAO,SAASC,OAAT,CAAiBC,GAAjB,EAAsBC,KAAtB,EAA6BC,UAAU,GAAG,IAA1C,EAAgDC,SAAS,GAAGP,cAA5D,EAA4E;AAC/E,SAAO,IAAID,UAAJ,CAAeS,UAAU,IAAI;AAChC,QAAIC,EAAE,GAAG,IAAT;AACAA,IAAAA,EAAE,GAAGL,GAAG,CAACE,UAAD,CAAH,CAAgBD,KAAhB,EAAuB,CAACK,QAAD,EAAWC,OAAX,KAAuB;AAC/CJ,MAAAA,SAAS,CAACK,QAAV,CAAmB,MAAM;AACrBJ,QAAAA,UAAU,CAACK,IAAX,CAAgB;AAAEH,UAAAA,QAAF;AAAYC,UAAAA;AAAZ,SAAhB;AACH,OAFD;;AAGA,UAAIL,UAAU,IAAI,MAAlB,EAA0B;AACtBC,QAAAA,SAAS,CAACK,QAAV,CAAmB,MAAMJ,UAAU,CAACM,QAAX,EAAzB;AACH;AACJ,KAPI,EAOFC,GAAG,IAAI;AACNR,MAAAA,SAAS,CAACK,QAAV,CAAmB,MAAMJ,UAAU,CAACQ,KAAX,CAAiBD,GAAjB,CAAzB;AACH,KATI,CAAL;;AAUA,QAAIT,UAAU,IAAI,IAAlB,EAAwB;AACpB,aAAO;AACHW,QAAAA,WAAW,GAAG;AACV,cAAIR,EAAE,IAAI,IAAV,EAAgB;AACZL,YAAAA,GAAG,CAACc,GAAJ,CAAQb,KAAR,EAAeI,EAAf;AACH;AACJ;;AALE,OAAP;AAOH,KARD,MASK;AACD,aAAO;AAAEQ,QAAAA,WAAW,GAAG,CAAG;;AAAnB,OAAP;AACH;AACJ,GAxBM,EAwBJE,IAxBI,CAwBClB,GAAG,CAACmB,OAAO,IAAI;AACnB,UAAM;AAAEV,MAAAA,QAAF;AAAYC,MAAAA;AAAZ,QAAwBS,OAA9B;AACA,QAAIC,GAAG,GAAG,IAAV;;AACA,QAAIX,QAAQ,CAACY,MAAT,EAAJ,EAAuB;AACnBD,MAAAA,GAAG,GAAGX,QAAQ,CAACW,GAAf;AACH;;AACD,WAAO;AAAEE,MAAAA,IAAI,EAAElB,KAAR;AAAee,MAAAA,OAAO,EAAEV,QAAxB;AAAkCC,MAAAA,OAAlC;AAA2CU,MAAAA;AAA3C,KAAP;AACH,GAPU,CAxBJ,EA+BHnB,KAAK,EA/BF,CAAP;AAgCH","sourcesContent":["import { Observable, asyncScheduler } from 'rxjs';\nimport { map, share } from 'rxjs/operators';\nexport function fromRef(ref, event, listenType = 'on', scheduler = asyncScheduler) {\n    return new Observable(subscriber => {\n        let fn = null;\n        fn = ref[listenType](event, (snapshot, prevKey) => {\n            scheduler.schedule(() => {\n                subscriber.next({ snapshot, prevKey });\n            });\n            if (listenType == 'once') {\n                scheduler.schedule(() => subscriber.complete());\n            }\n        }, err => {\n            scheduler.schedule(() => subscriber.error(err));\n        });\n        if (listenType == 'on') {\n            return {\n                unsubscribe() {\n                    if (fn != null) {\n                        ref.off(event, fn);\n                    }\n                }\n            };\n        }\n        else {\n            return { unsubscribe() { } };\n        }\n    }).pipe(map(payload => {\n        const { snapshot, prevKey } = payload;\n        let key = null;\n        if (snapshot.exists()) {\n            key = snapshot.key;\n        }\n        return { type: event, payload: snapshot, prevKey, key };\n    }), share());\n}\n"]},"metadata":{},"sourceType":"module"}